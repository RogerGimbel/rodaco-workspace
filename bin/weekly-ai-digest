#!/usr/bin/env bash
# Weekly AI/Tech Digest — searches X for latest from key voices and trending topics
# Called by cron job, output is used by the agent to compose a digest
set -euo pipefail

echo "=== AI/TECH WEEKLY DIGEST $(date '+%Y-%m-%d') ==="
echo ""

# Key voices — CEOs, CTOs, developers at major AI/tech companies
declare -a PEOPLE=(
  "from:sama"             # Sam Altman — OpenAI CEO
  "from:DarioAmodei"      # Dario Amodei — Anthropic CEO
  "from:alexalbert__"     # Alex Albert — Anthropic, Claude relations
  "from:karpathy"         # Andrej Karpathy — AI educator, ex-Tesla/OpenAI
  "from:rauchg"           # Guillermo Rauch — Vercel CEO
  "from:swyx"             # Shawn Wang — AI engineering, Latent Space
  "from:svpino"           # Santiago Valdarrama — AI engineering
  "from:elikiokn"         # Elik — AI/ML insights
  "from:copyconstruct"    # Cindy Sridharan — systems engineering
  "from:xaboranov"        # xAI / Grok updates
  "from:theprimeagen"     # ThePrimeagen — dev tooling, hot takes
  "from:levelsio"         # Pieter Levels — indie hacker, AI products
  "from:mcaboranov"       # McKay Wrigley — AI dev tools
  "from:nutlope"          # Hassan El Mghari — AI apps, Vercel
  "from:sdand"            # Supabase / open source
)

# Trending topics
declare -a TOPICS=(
  "AI agents 2026"
  "Claude Code OR Codex OR Cursor update"
  "MCP protocol"
  "agentic workflow OR agentic AI"
  "OpenAI announcement OR release"
  "Anthropic announcement OR release"  
  "xAI Grok update OR release"
  "Lovable update OR Replit update OR Bolt update"
  "open source AI model launch"
  "AI startup funding 2026"
)

echo "## KEY VOICES (last 7 days)"
echo ""
for query in "${PEOPLE[@]}"; do
  name=$(echo "$query" | sed 's/from://')
  echo "### @$name"
  bird search "$query" -n 3 2>/dev/null || echo "(no results)"
  echo ""
done

echo ""
echo "## TRENDING TOPICS (last 7 days)"
echo ""
for topic in "${TOPICS[@]}"; do
  echo "### $topic"
  bird search "$topic" -n 3 2>/dev/null || echo "(no results)"
  echo ""
done

echo ""
echo "=== END DIGEST ==="
