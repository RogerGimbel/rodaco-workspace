var q=s=>{throw TypeError(s)};var F=(s,n,o)=>n.has(s)||q("Cannot "+o);var u=(s,n,o)=>(F(s,n,"read from private field"),o?o.call(s):n.get(s)),E=(s,n,o)=>n.has(s)?q("Cannot add the same private member more than once"):n instanceof WeakSet?n.add(s):n.set(s,o),k=(s,n,o,r)=>(F(s,n,"write to private field"),r?r.call(s,o):n.set(s,o),o),L=(s,n,o)=>(F(s,n,"access private method"),o);import{c as Z,S as ie,s as le,h as z,g as ce,n as ee,u as se,r as j,a as de,b as xe,j as e,G as b,d as ue,e as N,C as A,E as M,f as B,X as he,i as P,k as H,M as te,l as me,m as ge,o as pe,p as fe,q as je,t as Ne,P as ve,T as ye,v as I,w as O,x as R,y as re,z as _}from"./index-D8zRiVxX.js";import{L as be}from"./lightbulb-DW3ZNMGS.js";import{C as we}from"./chevron-right-C4Ilwg2K.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=Z("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=Z("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);var v,S,f,y,w,$,U,J,Oe=(J=class extends ie{constructor(n,o){super();E(this,w);E(this,v);E(this,S);E(this,f);E(this,y);k(this,v,n),this.setOptions(o),this.bindMethods(),L(this,w,$).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(n){var r;const o=this.options;this.options=u(this,v).defaultMutationOptions(n),le(this.options,o)||u(this,v).getMutationCache().notify({type:"observerOptionsUpdated",mutation:u(this,f),observer:this}),o!=null&&o.mutationKey&&this.options.mutationKey&&z(o.mutationKey)!==z(this.options.mutationKey)?this.reset():((r=u(this,f))==null?void 0:r.state.status)==="pending"&&u(this,f).setOptions(this.options)}onUnsubscribe(){var n;this.hasListeners()||(n=u(this,f))==null||n.removeObserver(this)}onMutationUpdate(n){L(this,w,$).call(this),L(this,w,U).call(this,n)}getCurrentResult(){return u(this,S)}reset(){var n;(n=u(this,f))==null||n.removeObserver(this),k(this,f,void 0),L(this,w,$).call(this),L(this,w,U).call(this)}mutate(n,o){var r;return k(this,y,o),(r=u(this,f))==null||r.removeObserver(this),k(this,f,u(this,v).getMutationCache().build(u(this,v),this.options)),u(this,f).addObserver(this),u(this,f).execute(n)}},v=new WeakMap,S=new WeakMap,f=new WeakMap,y=new WeakMap,w=new WeakSet,$=function(){var o;const n=((o=u(this,f))==null?void 0:o.state)??ce();k(this,S,{...n,isPending:n.status==="pending",isSuccess:n.status==="success",isError:n.status==="error",isIdle:n.status==="idle",mutate:this.mutate,reset:this.reset})},U=function(n){ee.batch(()=>{var o,r,t,l,d,x,h,i;if(u(this,y)&&this.hasListeners()){const a=u(this,S).variables,c=u(this,S).context,m={client:u(this,v),meta:this.options.meta,mutationKey:this.options.mutationKey};if((n==null?void 0:n.type)==="success"){try{(r=(o=u(this,y)).onSuccess)==null||r.call(o,n.data,a,c,m)}catch(p){Promise.reject(p)}try{(l=(t=u(this,y)).onSettled)==null||l.call(t,n.data,null,a,c,m)}catch(p){Promise.reject(p)}}else if((n==null?void 0:n.type)==="error"){try{(x=(d=u(this,y)).onError)==null||x.call(d,n.error,a,c,m)}catch(p){Promise.reject(p)}try{(i=(h=u(this,y)).onSettled)==null||i.call(h,void 0,n.error,a,c,m)}catch(p){Promise.reject(p)}}}this.listeners.forEach(a=>{a(u(this,S))})})},J);function Q(s,n){const o=se(),[r]=j.useState(()=>new Oe(o,s));j.useEffect(()=>{r.setOptions(s)},[r,s]);const t=j.useSyncExternalStore(j.useCallback(d=>r.subscribe(ee.batchCalls(d)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),l=j.useCallback((d,x)=>{r.mutate(d,x).catch(de)},[r]);if(t.error&&xe(r.options.throwOnError,[t.error]))throw t.error;return{...t,mutate:l,mutateAsync:t.mutate}}function Y({task:s,index:n}){var h;const[o,r]=j.useState(!1),t=((s==null?void 0:s.status)||"").toLowerCase(),l=t.includes("progress")||t==="active"?"bg-success/20 text-success":t.includes("blocked")?"bg-error/20 text-error":t.includes("pending")?"bg-warning/20 text-warning":t.includes("done")||t.includes("complete")?"bg-muted/60 text-muted-foreground":"bg-info/20 text-info",d=t.includes("progress")||t==="active"?"ok":t.includes("blocked")?"error":"warning",x=new Map;return(h=s==null?void 0:s.checklist)==null||h.forEach(i=>{const a=(i==null?void 0:i.section)||"General";x.has(a)||x.set(a,[]),x.get(a).push(i)}),e.jsxs(b,{staggerIndex:n,className:"cursor-pointer",onClick:()=>r(!o),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[e.jsx(ue,{status:d}),e.jsx("span",{className:"text-sm text-foreground/90 truncate",children:(s==null?void 0:s.title)||"Untitled"}),e.jsx("span",{className:N("text-[10px] px-2 py-0.5 rounded-full shrink-0",l),children:(s==null?void 0:s.status)||"unknown"})]}),e.jsx(A,{className:N("w-4 h-4 text-muted-foreground transition-transform shrink-0",o&&"rotate-180")})]}),(s==null?void 0:s.nextStep)&&e.jsxs("p",{className:"text-xs text-success/70 mt-2",children:["â†’ ",s.nextStep]}),o&&e.jsxs("div",{className:"mt-4 space-y-3 border-t border-border pt-3",children:[(s==null?void 0:s.started)&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Started: ",s.started]}),(s==null?void 0:s.plan)&&s.plan.length>0&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"label-text",children:"Plan"}),s.plan.map((i,a)=>e.jsx("p",{className:"text-xs text-foreground/70 pl-1",children:i},a))]}),x.size>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"label-text",children:"Checklist"}),Array.from(x.entries()).map(([i,a])=>e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] text-muted-foreground uppercase tracking-wider mb-1",children:i}),a.map((c,m)=>e.jsxs("div",{className:"flex items-start gap-2 py-0.5",children:[e.jsx("span",{className:"text-xs shrink-0",children:c!=null&&c.done?"âœ…":"â¬œ"}),e.jsx("span",{className:"text-xs text-foreground/70",children:(c==null?void 0:c.text)||""})]},m))]},i))]})]})]})}function G(s){return s.replace(/```[\s\S]*?```/g,"").replace(/`([^`]+)`/g,"$1").replace(/\*\*([^*]+)\*\*/g,"$1").replace(/\*([^*]+)\*/g,"$1").replace(/^#+\s*/gm,"").trim()}function Te({data:s}){var n,o;return e.jsxs("div",{className:"space-y-4",children:[(s==null?void 0:s.role)&&e.jsxs(b,{staggerIndex:0,children:[e.jsx("p",{className:"label-text mb-2",children:"Role"}),e.jsx("p",{className:"text-sm text-foreground/80",children:G(s.role)})]}),((s==null?void 0:s.projects)??[]).map((r,t)=>{const l=(r==null?void 0:r.items)||(r==null?void 0:r.tasks)||[];return e.jsxs(b,{staggerIndex:t+1,children:[e.jsx("p",{className:"text-sm font-medium text-foreground/90 mb-1",children:(r==null?void 0:r.name)||"Project"}),(r==null?void 0:r.description)&&e.jsx("p",{className:"text-xs text-muted-foreground mb-3",children:r.description}),l.map((d,x)=>e.jsx("p",{className:"text-sm text-foreground/70 py-0.5 pl-1",children:G(d)},x))]},(r==null?void 0:r.name)||t)}),((s==null?void 0:s.antiGoals)??[]).length>0&&e.jsxs(b,{staggerIndex:(((n=s==null?void 0:s.projects)==null?void 0:n.length)??0)+1,children:[e.jsx("p",{className:"label-text mb-2 text-error/60",children:"Anti-Goals"}),(s.antiGoals??[]).map((r,t)=>e.jsx("p",{className:"text-sm text-foreground/70 py-0.5",children:G(r)},t))]}),((s==null?void 0:s.overnightTasks)??[]).length>0&&e.jsxs(b,{staggerIndex:(((o=s==null?void 0:s.projects)==null?void 0:o.length)??0)+2,children:[e.jsx("p",{className:"label-text mb-2 text-purple/60",children:"Overnight Tasks"}),(s.overnightTasks??[]).map((r,t)=>e.jsx("p",{className:"text-sm text-foreground/70 py-0.5",children:G(r)},t))]})]})}function V({text:s}){const n=s.split(`
`);return e.jsx("div",{className:"space-y-1.5",children:n.map((o,r)=>{const t=o.trimStart();return t.startsWith("#### ")?e.jsx("p",{className:"text-xs font-bold text-foreground/70 mt-3 mb-1",children:t.slice(5)},r):t.startsWith("### ")?e.jsx("p",{className:"text-sm font-bold text-foreground/70 mt-3 mb-1",children:t.slice(4)},r):t.startsWith("## ")?e.jsx("p",{className:"text-sm font-bold text-foreground/80 mt-4 mb-1",children:t.slice(3)},r):t.startsWith("# ")?e.jsx("p",{className:"text-base font-bold text-foreground/90 mt-4 mb-1",children:t.slice(2)},r):t.startsWith("```")?null:t.startsWith("- ")||t.startsWith("* ")?e.jsxs("div",{className:"flex items-start gap-2 pl-2",children:[e.jsx("span",{className:"text-muted-foreground mt-0.5",children:"â€¢"}),e.jsx("span",{className:"text-sm text-foreground/60 leading-relaxed",children:e.jsx(X,{text:t.slice(2)})})]},r):t?e.jsx("p",{className:"text-sm text-foreground/60 leading-relaxed",children:e.jsx(X,{text:t})},r):e.jsx("div",{className:"h-1"},r)})})}function X({text:s}){const n=[],o=/(\*\*(.+?)\*\*|`([^`]+)`)/g;let r=0,t;for(;(t=o.exec(s))!==null;)t.index>r&&n.push(s.slice(r,t.index)),t[2]?n.push(e.jsx("strong",{className:"text-foreground/80 font-semibold",children:t[2]},t.index)):t[3]&&n.push(e.jsx("code",{className:"text-xs bg-muted/60 rounded px-1 py-0.5 font-mono text-info/70",children:t[3]},t.index)),r=t.index+t[0].length;return r<s.length&&n.push(s.slice(r)),e.jsx(e.Fragment,{children:n})}function Ee(s){return s.split(/\s+/).filter(Boolean).length}function ke(s){if(!s)return"";try{return new Date(s+"T00:00:00").toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"})}catch{return s}}function Le({data:s,dateStr:n}){var h;const[o,r]=j.useState(new Set);if(!s||!((h=s.sections)!=null&&h.length)&&!Object.keys(s).some(i=>typeof s[i]=="string"&&i!=="date"))return e.jsxs("div",{className:"glass-card p-8 flex flex-col items-center justify-center gap-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-muted/40 flex items-center justify-center",children:e.jsx("span",{className:"text-foreground/20 text-lg",children:"ðŸŒ™"})}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"No overnight activity recorded for this date"})]});const t=i=>r(a=>{const c=new Set(a);return c.has(i)?c.delete(i):c.add(i),c}),l=(s.sections??[]).reduce((i,a)=>i+Ee(a.content??""),0),d=ke(s.date??n);if(s.sections&&s.sections.length>0)return e.jsxs("div",{className:"space-y-3",children:[(l>0||d)&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:[l>0&&e.jsxs("span",{children:[l.toLocaleString()," words"]}),l>0&&d&&e.jsx("span",{children:" Â· "}),d&&e.jsx("span",{children:d})]}),s.sections.map((i,a)=>{const c=o.has(a);return e.jsxs(b,{staggerIndex:a,className:"!p-0 overflow-hidden",children:[e.jsxs("button",{onClick:()=>t(a),className:"flex items-center justify-between w-full px-5 py-3.5 hover:bg-muted/30 transition-colors",children:[e.jsx("p",{className:"text-sm font-medium text-foreground/80 text-left",children:(i==null?void 0:i.title)??`Section ${a+1}`}),e.jsx(A,{className:N("w-4 h-4 text-muted-foreground transition-transform shrink-0",!c&&"rotate-180")})]}),!c&&(i==null?void 0:i.content)&&e.jsx("div",{className:"px-5 pb-4 border-t border-border pt-3",children:e.jsx(V,{text:i.content})})]},a)})]});const x=Object.entries(s).filter(([i,a])=>typeof a=="string"&&i!=="date");return e.jsx("div",{className:"space-y-3",children:x.map(([i,a],c)=>e.jsxs(b,{staggerIndex:c,children:[e.jsx("p",{className:"text-sm font-medium text-foreground/70 mb-2 capitalize",children:i}),e.jsx(V,{text:a})]},i))})}const De={high:"bg-error/15 text-error",medium:"bg-warning/15 text-warning",low:"bg-success/15 text-success"},Ie={small:"bg-success/10 text-success/70",medium:"bg-warning/10 text-warning/70",large:"bg-error/10 text-error/70"},Re={infrastructure:"bg-info/10 text-info/70",project:"bg-purple/10 text-purple/70",research:"bg-warning/10 text-warning/70"};function W({task:s,index:n}){const[o,r]=j.useState(!1),t=se(),l=Q({mutationFn:()=>H(`suggested-tasks/${s.id}/approve`),onSuccess:()=>{t.invalidateQueries({queryKey:["suggested-tasks"]}),P.success("Task approved",{duration:3e3})},onError:()=>P.warning("Failed to approve task")}),d=Q({mutationFn:()=>H(`suggested-tasks/${s.id}/reject`),onSuccess:()=>{t.invalidateQueries({queryKey:["suggested-tasks"]}),P.success("Task dismissed",{duration:3e3})},onError:()=>P.warning("Failed to dismiss task")}),x=s.status==="approved",h=s.status==="rejected",i=!x&&!h,a=De[(s.priority??"").toLowerCase()]??"bg-muted/60 text-muted-foreground",c=Ie[(s.effort??"").toLowerCase()]??"bg-muted/60 text-muted-foreground",m=Re[(s.category??"").toLowerCase()]??"bg-muted/60 text-muted-foreground";return e.jsxs(b,{staggerIndex:n,className:N("!p-0 overflow-hidden transition-opacity duration-300",h&&"opacity-50"),children:[e.jsxs("button",{onClick:()=>r(!o),className:"w-full px-4 py-3.5 flex items-start gap-3 text-left hover:bg-muted/30 transition-colors",children:[x&&e.jsx(B,{className:"w-4 h-4 text-success mt-0.5 shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:N("text-sm font-medium text-foreground/85",h&&"line-through text-muted-foreground"),children:s.title}),e.jsxs("div",{className:"flex flex-wrap gap-1.5 mt-2",children:[s.priority&&e.jsx("span",{className:N("text-[10px] px-2 py-0.5 rounded-full capitalize font-medium",a),children:s.priority}),s.effort&&e.jsx("span",{className:N("text-[10px] px-2 py-0.5 rounded-full capitalize font-medium",c),children:s.effort}),s.category&&e.jsx("span",{className:N("text-[10px] px-2 py-0.5 rounded-full capitalize font-medium",m),children:s.category})]})]}),e.jsx(A,{className:N("w-4 h-4 text-muted-foreground transition-transform shrink-0 mt-1",o&&"rotate-180")})]}),o&&e.jsxs("div",{className:"px-4 pb-4 border-t border-border pt-3 space-y-3",children:[s.reasoning&&e.jsx("p",{className:"text-sm text-muted-foreground leading-relaxed italic",children:s.reasoning}),i&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>l.mutate(),disabled:l.isPending,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs rounded-lg bg-success/15 text-success hover:bg-success/25 transition-colors disabled:opacity-50",children:[e.jsx(B,{className:"w-3 h-3"})," ",l.isPending?"Approvingâ€¦":"Approve"]}),e.jsxs("button",{onClick:()=>d.mutate(),disabled:d.isPending,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs rounded-lg bg-error/15 text-error hover:bg-error/25 transition-colors disabled:opacity-50",children:[e.jsx(he,{className:"w-3 h-3"})," ",d.isPending?"Dismissingâ€¦":"Dismiss"]})]})]})]})}function Me({tasks:s}){const n=s.filter(t=>t.status!=="approved"&&t.status!=="rejected"),o=s.filter(t=>t.status==="approved"),r=s.filter(t=>t.status==="rejected");return s!=null&&s.length?e.jsxs("div",{className:"space-y-6",children:[n.length>0&&e.jsx("div",{className:"space-y-3",children:n.map((t,l)=>e.jsx(W,{task:t,index:l},t.id))}),o.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("p",{className:"label-text text-success",children:["Planned (",o.length,")"]}),o.map((t,l)=>e.jsx(W,{task:t,index:n.length+l},t.id))]}),r.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("p",{className:"label-text text-muted-foreground",children:["Dismissed (",r.length,")"]}),r.map((t,l)=>e.jsx(W,{task:t,index:n.length+o.length+l},t.id))]})]}):e.jsx(M,{message:"No suggested tasks â€” Rodaco will generate new ones during overnight builds",icon:e.jsx(be,{className:"w-5 h-5 text-warning/30"})})}const K=5,Pe={opus:"bg-purple-500/20 text-purple-300",sonnet:"bg-info/20 text-info",grok:"bg-warning/20 text-warning"};function Ge(s){return s.replace(/\*\*([^*]+)\*\*/g,"$1").replace(/\*([^*]+)\*/g,"$1").replace(/`([^`]+)`/g,"$1").replace(/^#+\s*/gm,"").trim()}function $e(s){return!!(s.duration!=null||s.modelUsed!=null||s.cost!=null||s.tasksCompleted!=null||s.summary||(s.highlights??[]).length>0)}function Ae({data:s}){var i;const[n,o]=j.useState(!1),[r,t]=j.useState(new Set),l=(s==null?void 0:s.builds)||[],d=n?l:l.slice(0,K),x=((i=s==null?void 0:s.stats)==null?void 0:i.totalTasks)??(s==null?void 0:s.totalBuilds)??l.length;if(!l.length)return e.jsxs("div",{className:"glass-card p-8 flex flex-col items-center justify-center gap-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-muted/40 flex items-center justify-center",children:e.jsx(te,{className:"w-5 h-5 text-muted-foreground"})}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"No overnight builds recorded yet"})]});const h=a=>t(c=>{const m=new Set(c);return m.has(a)?m.delete(a):m.add(a),m});return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"label-text",children:"Overnight History"}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[x," total tasks completed"]})]}),e.jsx("div",{className:"relative space-y-3 pl-4 border-l border-border",children:d.map((a,c)=>{if(!$e(a))return e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute -left-[21px] top-2.5 w-2.5 h-2.5 rounded-full bg-muted/80 border-2 border-[hsl(var(--background))]"}),e.jsxs("div",{className:"glass-card !py-2 !px-4 flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:(a==null?void 0:a.date)??"â€”"}),e.jsx("span",{className:"text-[11px] text-muted-foreground",children:"Build completed"})]})]},c);const p=r.has(c),g=a!=null&&a.summary?Ge(a.summary):"",T=g.length>150,C=(a==null?void 0:a.highlights)??[],ne=((a==null?void 0:a.modelUsed)??"").toLowerCase(),ae=Pe[ne]??"bg-muted/70 text-muted-foreground";return e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute -left-[21px] top-3 w-2.5 h-2.5 rounded-full bg-purple-400/60 border-2 border-[hsl(var(--background))]"}),e.jsxs(b,{staggerIndex:c,className:"cursor-pointer",onClick:()=>(T||C.length>0)&&h(c),children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-foreground/80",children:(a==null?void 0:a.date)??"â€”"}),(a==null?void 0:a.duration)!=null&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-[10px] text-muted-foreground/60",children:"â€¢"}),e.jsxs("span",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[e.jsx(me,{className:"w-3 h-3"})," ",a.duration]})]})]}),(a==null?void 0:a.cost)!=null&&e.jsxs("span",{className:"text-[10px] px-2 py-0.5 rounded-full bg-success/15 text-success",children:["$",Number(a.cost).toFixed(2)]})]}),e.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[(a==null?void 0:a.tasksCompleted)!=null&&e.jsxs("span",{className:"text-[11px] text-muted-foreground flex items-center gap-1",children:[e.jsx(B,{className:"w-3 h-3 text-success/60"}),a.tasksCompleted," tasks"]}),(a==null?void 0:a.modelUsed)!=null&&e.jsx("span",{className:`text-[10px] px-2 py-0.5 rounded-full font-medium ${ae}`,children:a.modelUsed})]}),g&&e.jsxs("p",{className:"text-xs text-foreground/55 leading-relaxed",children:[p||!T?g:`${g.slice(0,150)}â€¦`,T&&!C.length&&e.jsx("button",{onClick:D=>{D.stopPropagation(),h(c)},className:"ml-1 text-purple-400/70 hover:text-purple-400 transition-colors",children:p?"Show less":"Read more"})]}),C.length>0&&e.jsx(e.Fragment,{children:p?e.jsx("ul",{className:"mt-2 space-y-1 list-disc list-inside",children:C.map((D,oe)=>e.jsx("li",{className:"text-xs text-foreground/55",children:D},oe))}):e.jsxs("button",{onClick:D=>{D.stopPropagation(),h(c)},className:"mt-1 text-[11px] text-purple-400/70 hover:text-purple-400 transition-colors",children:[C.length," highlight",C.length>1?"s":""," â€” show"]})})]})]},c)})}),l.length>K&&!n&&e.jsxs("button",{onClick:()=>o(!0),className:"w-full glass-card py-2.5 text-xs text-muted-foreground hover:text-foreground/70 transition-colors flex items-center justify-center gap-1",children:[e.jsx(A,{className:"w-3.5 h-3.5"}),"Show ",l.length-K," older builds"]})]})}function Fe({tasks:s}){const n=s.filter(r=>!_(r)),o=s.filter(r=>_(r));return e.jsxs("div",{className:"space-y-6",children:[n.length>0?e.jsx("div",{className:"space-y-3",children:n.map((r,t)=>e.jsx(Y,{task:r,index:t},r.title||t))}):e.jsx(M,{message:"All tasks completed âœ…",icon:e.jsx(re,{className:"w-5 h-5 text-muted-foreground/40"})}),o.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"label-text text-muted-foreground",children:"Completed"}),e.jsx("div",{className:"space-y-3 opacity-50",children:o.map((r,t)=>e.jsx(Y,{task:r,index:n.length+t},r.title||t))})]})]})}function qe(){var c,m,p;const[s,n]=j.useState("Tasks"),[o,r]=j.useState(()=>new Date().toISOString().slice(0,10)),t=ge(),l=pe(),d=fe(o),x=je(),h=Ne(),i=((c=x.data)==null?void 0:c.tasks)||[],a=i.filter(g=>g.status!=="approved"&&g.status!=="rejected").length;return e.jsxs(e.Fragment,{children:[e.jsx(ve,{title:"Ops",subtitle:"Tasks, goals, and overnight operations",breadcrumb:s.startsWith("Suggested")?"Suggested":s,onBreadcrumbRoot:()=>n("Tasks")}),e.jsx(ye,{tabs:["Tasks","Goals","Overnight",`Suggested${a>0?` (${a})`:""}`],active:s,onChange:n,className:"mb-8"}),s==="Tasks"&&e.jsx(I,{label:"Tasks",children:e.jsx("div",{className:"space-y-3",children:t.isLoading?e.jsxs(e.Fragment,{children:[e.jsx(O,{lines:3}),e.jsx(O,{lines:3})]}):t.isError?e.jsx(R,{label:"active tasks",onRetry:()=>t.refetch()}):(p=(m=t.data)==null?void 0:m.tasks)!=null&&p.length?e.jsx(Fe,{tasks:t.data.tasks}):e.jsx(M,{message:"No active tasks",icon:e.jsx(re,{className:"w-5 h-5 text-muted-foreground/40"})})})}),s==="Goals"&&e.jsx(I,{label:"Goals",children:l.isLoading?e.jsx(O,{lines:6}):l.isError?e.jsx(R,{label:"goals",onRetry:()=>l.refetch()}):l.data?e.jsx(Te,{data:l.data}):e.jsx(M,{message:"No goals defined yet",icon:e.jsx(Se,{className:"w-5 h-5 text-muted-foreground/40"})})}),s==="Overnight"&&e.jsx(I,{label:"Overnight",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"label-text text-muted-foreground",children:"View overnight log for:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>{const g=new Date(o+"T00:00:00");g.setDate(g.getDate()-1),r(g.toISOString().slice(0,10))},className:"glass-card-hover !p-2 text-muted-foreground hover:text-foreground transition-colors","aria-label":"Previous day",children:e.jsx(Ce,{className:"w-4 h-4"})}),e.jsx("input",{type:"date",value:o,onChange:g=>r(g.target.value),className:"glass-card px-4 py-2 text-sm text-foreground/70 bg-transparent outline-none flex-1 text-center"}),e.jsx("button",{onClick:()=>{const g=new Date(o+"T00:00:00");g.setDate(g.getDate()+1);const T=g.toISOString().slice(0,10),C=new Date().toISOString().slice(0,10);T<=C&&r(T)},className:"glass-card-hover !p-2 text-muted-foreground hover:text-foreground transition-colors","aria-label":"Next day",children:e.jsx(we,{className:"w-4 h-4"})})]})]}),d.isLoading?e.jsx(O,{lines:4}):d.isError?e.jsx(R,{label:"overnight log",onRetry:()=>d.refetch()}):e.jsx(Le,{data:d.data,dateStr:o}),e.jsx(I,{label:"Overnight History",children:h.isLoading?e.jsx(O,{lines:4}):h.isError?e.jsx(R,{label:"overnight history",onRetry:()=>h.refetch()}):h.data?e.jsx(Ae,{data:h.data}):e.jsx(M,{message:"No overnight builds recorded yet",icon:e.jsx(te,{className:"w-5 h-5 text-foreground/15"})})})]})}),s.startsWith("Suggested")&&e.jsx(I,{label:"Suggested Tasks",children:x.isLoading?e.jsxs(e.Fragment,{children:[e.jsx(O,{lines:3}),e.jsx(O,{lines:3})]}):x.isError?e.jsx(R,{label:"suggested tasks",onRetry:()=>x.refetch()}):e.jsx(Me,{tasks:i})})]})}export{qe as default};
